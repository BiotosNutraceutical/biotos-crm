:root{
  /* Palette scura (default) */
  --bg:#07130e; --panel:#0c2319; --panel2:#0a1c15; --muted:#b7d9ca; --text:#f6fffa;
  --accent:#0b8f5c; --accent-2:#10b97a; --line:#1a563b; --danger:#ff6b6b; --ok:#28d07e;
  --focus: rgba(16,185,122,.42);

  /* Bottoni (scuro) */
  --btn-bg:#124f37;           /* sfondo button */
  --btn-text:#f6fffa;         /* testo button */
  --btn-border:#1a563b;       /* bordo button */

  /* Misure UI */
  --nav-h:60px;               /* +altezza per iPhone 16/Notch */
  --maxw:1100px;
}

[data-theme="light"]{
  /* Palette chiara con alto contrasto */
  --bg:#f6fbf8; --panel:#ffffff; --panel2:#f2f7f4; --muted:#385547; --text:#0a1f16; --line:#d7e8df;
  --accent:#0b8f5c; --accent-2:#087e52; --focus: rgba(11,143,92,.32);

  /* Bottoni (chiaro): verde pieno + testo bianco */
  --btn-bg:#0b8f5c;
  --btn-text:#ffffff;
  --btn-border:#0b8f5c;
}

[data-theme="hc"]{
  --bg:#000; --panel:#000; --panel2:#000; --muted:#eafff6; --text:#fff; --line:#3ddc97;
  --accent:#3ddc97; --accent-2:#aaffcc; --focus:#3ddc97;

  --btn-bg:#0b0; --btn-text:#000; --btn-border:#3ddc97;
}

*{box-sizing:border-box}
html,body{
  margin:0; height:auto; min-height:100%;
  background:var(--bg); color:var(--text);
  font:16px/1.55 -apple-system,BlinkMacSystemFont,system-ui,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial
}
.hidden{display:none!important}
a{color:inherit;text-decoration:none}

.wrap{max-width:var(--maxw);margin:0 auto;padding:8px 12px 10px}

/* Header compatto + safe area top */
header{
  position:sticky; top:0; z-index:50;
  background:var(--bg); border-bottom:1px solid rgba(23,86,59,.35);
  padding-top:calc(2px + env(safe-area-inset-top));
}
h1{font-size:16px;margin:0;display:flex;align-items:center;gap:8px}
h1 img{width:22px;height:22px;border-radius:6px;border:1px solid var(--line);background:#fff}
.savebadge{margin-left:auto;font-size:11px;color:#bfe5cf}
.profilebadge{margin-left:10px;font-size:12px;color:#a5e9cb;opacity:.95}

/* Topbar più stretta su mobile */
.topbar{display:flex;gap:8px;align-items:center;margin:4px 0}
.topbar input[type="search"]{flex:1;background:var(--panel2);border:1px solid var(--line);border-radius:12px;padding:10px 12px;min-height:40px;color:var(--text)}

input,select,textarea{
  width:100%; background:var(--panel2); color:var(--text);
  border:1px solid var(--line); border-radius:12px; padding:10px; min-height:40px
}
input:focus,select:focus,textarea:focus,.btn:focus{outline:2px solid var(--focus); outline-offset:1px}
label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}

/* Bottoni leggibili in tutti i temi */
.btn{
  display:inline-flex; gap:8px; align-items:center; cursor:pointer;
  border:1px solid var(--btn-border); border-radius:12px; min-height:40px;
  background:var(--btn-bg); color:var(--btn-text); padding:10px 12px;
  user-select:none; -webkit-user-select:none; text-align:center
}
.btn.primary{
  background:linear-gradient(180deg, color-mix(in srgb, var(--btn-bg) 92%, #fff 8%), color-mix(in srgb, var(--btn-bg) 85%, #000 15%));
  border-color:var(--btn-border)
}
.btn.ghost{
  background:transparent; color:var(--text); border:1px solid var(--line)
}
.btn:disabled, .btn[aria-disabled="true"]{
  opacity:.55; cursor:not-allowed
}

/* Cards & layout */
.grid{display:grid;gap:8px}
.pan{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:10px}
.row{display:flex;gap:8px;flex-wrap:wrap}
.row>*{flex:1 1 260px}
.cards{display:grid;gap:8px}
.card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:10px;display:flex;gap:10px}
.card .main{flex:1;min-width:0}
.card .title{font-weight:800;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.card .meta{font-size:13px;color:#cfe8dc}

/* Tag chips */
.chips{display:flex;gap:6px;flex-wrap:wrap;margin:4px 0}
.chip{border:1px solid var(--line);background:var(--panel2);padding:4px 8px;border-radius:999px;font-size:12px}
.chip.on{border-color:var(--accent);background:rgba(11,143,92,.14)}

/* Bottom nav – altezza + safe area; icone non tagliate */
.bottomnav{
  position:fixed; left:0; right:0; bottom:0; z-index:45;
  background:var(--bg); border-top:1px solid var(--line);
  display:flex; gap:6px; align-items:center;
  padding:6px env(safe-area-inset-right) calc(10px + env(safe-area-inset-bottom)) env(safe-area-inset-left);
  height:calc(var(--nav-h) + env(safe-area-inset-bottom));
  overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none
}
.bottomnav::-webkit-scrollbar{display:none}
.bottomnav a{
  flex:0 0 auto; min-height:40px; min-width:56px;
  border:1px solid var(--line); background:var(--panel2); color:var(--text);
  padding:8px 10px; border-radius:10px; font-size:14px; display:inline-flex; align-items:center; gap:6px; justify-content:center
}
.bottomnav a.active{border-color:var(--accent); background:color-mix(in srgb, var(--accent) 16%, var(--panel2))}
@media (max-width:430px){ .bottomnav a span.label{display:none} }

/* Assicura spazio per la nav su tutte le pagine */
main{padding-bottom:calc(var(--nav-h) + env(safe-area-inset-bottom) + 22px)}

.toast{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom:calc(var(--nav-h) + env(safe-area-inset-bottom) + 24px);
  background:#0f2e22; border:1px solid var(--line); padding:8px 12px; border-radius:12px; z-index:70; display:none
}
.toast.show{display:block}

/* Modali (foglio) */
.sheet{position:fixed; inset:0; display:none; background:rgba(0,0,0,.5); z-index:60}
.sheet.open{display:block}
.sheet .panel{
  position:absolute; left:0; right:0; bottom:0;
  background:var(--panel); border-top-left-radius:16px; border-top-right-radius:16px; border:1px solid var(--line);
  padding:10px 10px calc(14px + env(safe-area-inset-bottom)); max-height:90vh; overflow:auto
}

/* Micro-ritocchi */
.smallgap{margin-top:2px}
